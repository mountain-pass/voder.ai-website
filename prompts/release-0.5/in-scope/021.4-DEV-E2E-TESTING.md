# DEV-E2E-TESTING: End-to-End Testing Pipeline

## Release Goal

_"Release 0.5: Problem Validation - Ensure comprehensive user workflow validation"_

Implement GitHub Actions E2E testing workflow using Playwright that performs comprehensive end-to-end testing across multiple browsers and validates user workflows. This workflow runs after production build validation and provides thorough functional testing.

## How This Story Contributes

This story ensures user workflow integrity by implementing a specialized E2E testing pipeline that validates user interactions, application behavior, and functional requirements across different browsers. It provides comprehensive functional validation to complement production build verification.

## User Story

So that I can be confident all user workflows function correctly across browsers, as a developer, I want an E2E testing workflow that runs comprehensive Playwright tests, validates user interactions, and performs cross-browser testing after production builds are validated.

**INVEST Criteria Compliance**:

- **Independent**: ❌ DEPENDENT - Requires 021.3-DEV-CI-BUILD production build workflow to complete first for deployment artifacts
- **Negotiable**: ✅ Test scenarios, browser coverage, and test configuration can be refined
- **Valuable**: ✅ Validates user workflows and prevents functional regressions before deployment
- **Estimable**: ✅ Clear scope focused on Playwright E2E testing framework and user workflow validation. Estimated 1-2 sprints
- **Small**: ✅ APPROPRIATELY SIZED - Single concern focused on E2E testing with clear boundaries
- **Testable**: ✅ Success measured by E2E test execution, cross-browser compatibility, and user workflow validation

## Acceptance Criteria

- [ ] **E2E Testing Workflow**: ci-e2e.yml workflow runs after production build validation
- [ ] **Playwright Framework**: Complete Playwright setup with cross-browser testing
- [ ] **User Workflow Tests**: E2E tests covering all critical user workflows
- [ ] **Cross-Browser Testing**: Tests run on Chromium, Firefox, and WebKit
- [ ] **Console Error Detection**: Validate no console errors during user workflows
- [ ] **Error Handling**: Test error scenarios and edge cases
- [ ] **Test Artifacts**: Preserve test results and failure screenshots
- [ ] **Workflow Dependencies**: Only runs after 021.3-DEV-CI-BUILD passes
- [ ] **Status Reporting**: Clear GitHub status for E2E testing with detailed results

## Requirements

### E2E Testing Framework

- **REQ-PLAYWRIGHT-SETUP**: Playwright framework configured for comprehensive testing
- **REQ-USER-WORKFLOW-TESTS**: E2E tests covering:
  - Page loading and rendering validation
  - Navigation functionality across all pages
  - Key user interactions and form submissions
  - Console error detection and validation
  - Error handling scenarios and edge cases
  - Performance validation during user workflows
- **REQ-BROWSER-MATRIX**: Tests execute across Chromium, Firefox, and WebKit browsers
- **REQ-ACCESSIBILITY-BASIC**: Basic accessibility validation during E2E testing

### Test Execution and Reliability

- **REQ-WORKFLOW-DEPENDENCY**: Only runs after 021.3-DEV-CI-BUILD workflow succeeds
- **REQ-BUILD-ARTIFACT-USAGE**: Use production build artifacts from 021.3-DEV-CI-BUILD
- **REQ-BROWSER-CACHING**: Cache Playwright browsers for faster execution
- **REQ-PARALLEL-EXECUTION**: Run tests in parallel across browsers for efficiency
- **REQ-RETRY-LOGIC**: Implement test retry logic for flaky test mitigation

### Artifact Management and Reporting

- **REQ-TEST-ARTIFACTS**: Preserve test results, failure screenshots, and logs
- **REQ-FAILURE-DEBUGGING**: Capture detailed failure information for debugging
- **REQ-CLI-ASSESSMENT**: E2E test status verifiable via `gh run list` and `gh run view`
- **REQ-TEST-REPORTING**: Generate comprehensive test reports with pass/fail details

### Integration Points

- **REQ-WORKFLOW-TRIGGERS**: Trigger after production build validation succeeds
- **REQ-DEPENDENCY-CACHING**: Cache dependencies for faster execution
- **REQ-ARTIFACT-DOWNLOAD**: Download production build artifacts for testing

## Dependencies

- 021.3-DEV-CI-BUILD (requires production build artifacts and validated deployment readiness)

## Implementation Notes

### Workflow Structure (ci-e2e.yml)

```yaml
name: End-to-End Testing
on:
  workflow_run:
    workflows: ['Production Build Validation']
    types: [completed]
    branches: [main]

jobs:
  e2e-testing:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    strategy:
      matrix:
        browser: [chromium, firefox, webkit]
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      # Download production build artifacts
      - name: Download production build
        uses: actions/download-artifact@v4
        with:
          name: production-build
          path: dist/

      - name: Install dependencies
        run: npm ci

      - name: Install Playwright browsers
        run: npx playwright install ${{ matrix.browser }}

      - name: Run E2E tests
        run: npm run test:e2e -- --project=${{ matrix.browser }}
        env:
          CI: true

      - name: Upload test results
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: e2e-results-${{ matrix.browser }}
          path: |
            test-results/
            playwright-report/
          retention-days: 30
```

### Test Coverage Areas

- **Page Loading**: Validate all pages load correctly
- **Navigation**: Test all navigation paths and routing
- **User Interactions**: Forms, buttons, links, and interactive elements
- **Error Scenarios**: 404 pages, network failures, validation errors
- **Performance**: Basic performance validation during workflows
- **Console Validation**: Ensure no JavaScript errors during testing

### Integration with Other Workflows

- **Input**: Production build artifacts from 021.3-DEV-CI-BUILD
- **Parallel**: Can run in parallel with 021.5-DEV-VISUAL-REGRESSION
- **Output**: Test results and artifacts for deployment decision making
